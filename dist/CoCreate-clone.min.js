!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.clone=t():(e.CoCreate=e.CoCreate||{},e.CoCreate.clone=t())}(this,function(){return o={},r.m=n=[function(e,t,n){"use strict";n.r(t);n={__cloneBtnClass:"cloneBtn",__deleteBtnClass:"deleteBtn",init:function(){this.__initButtonEvent(),CoCreate.socket.listen("CoCreateClone-insert",function(e){var t=e.selector,n=e.element_str,e=e.position;!t||(t=document.querySelector(t))&&(e="after"==e?"afterend":"beforebegin",t.insertAdjacentHTML(e,n))}),CoCreate.socket.listen("CoCreateClone-delete",function(e){e=e.element_id;!e||(e=document.getElementById(e))&&e.remove()})},__initButtonEvent:function(){},cloneElement:function(e){var t,n=e.getAttribute("data-clone_id"),o=e.getAttribute("data-clone_name"),r=e.getAttribute("data-clone_position")||"before";n&&((e=document.getElementById(o))&&(t=e.value||""),(o=document.getElementById(n))&&((e=o.cloneNode(!0)).classList.contains("template")&&e.classList.remove("template"),e.classList.add("clonedItem"),e.removeAttribute("data-pass_value_id"),e.querySelectorAll("*").forEach(function(e){e.removeAttribute("data-pass_value_id")}),t=this.__getNewPrefix(t),this.__createDynamicCloneId(e,t),this.__createDnDElementId(e),"after"===r?o.nextSibling?o.parentNode.insertBefore(e,o.nextSibling):o.parentNode.appendChild(e):o.parentNode.insertBefore(e,o),(t=CoCreateHtmlTags.findElementByChild(e))&&this.__sendMessageOfClone(t,e,n,r),document.dispatchEvent(new CustomEvent("change-content",{detail:{element:e,type:"clone-create"}})),o.parentNode.dispatchEvent(new CustomEvent("CoCreate-clone",{detail:{type:"create"}})),document.dispatchEvent(new CustomEvent("clone-cloned",{detail:{element:e}}))))},deleteElement:function(e){var t=e.getAttribute("data-clone_id"),n=document.getElementById(t);n&&(e=n.parentNode,n.remove(),this.__sendMessageOfDelete(t),e&&(document.dispatchEvent(new CustomEvent("change-content",{detail:{element:e,type:"clone-delete"}})),e.dispatchEvent(new CustomEvent("CoCreate-clone",{detail:{type:"delete"}}))),document.dispatchEvent(new CustomEvent("clone-deleted",{detail:{}})))},__createDynamicCloneId:function(a,i){var l=this,e=a.querySelectorAll("*"),t=a.querySelectorAll("."+this.__cloneBtnClass),n=a.querySelectorAll("."+this.__deleteBtnClass);(e=Array.from(e)).push(a),a.setAttribute("id",i),e.forEach(function(e){for(var t=e.tagName.toLowerCase(),n=0;n<e.attributes.length;n++){var o=e.attributes[n],r=o.name,o=o.value,a=o.replace(/{{\s*clone-name\s*}}/g,i);if(/{{\s*clone-name\s*}}/g.test(o)&&"value"==r)switch(t){case"input":e.setAttribute("value",a);break;case"textarea":e.setAttribute("value",a),e.textContent=a;break;default:e.innerHTML=a}e.setAttribute(r,a)}}),t.forEach(function(e){var t,n,o=e.getAttribute("data-clone_id"),r=e.getAttribute("data-clone_name");o&&(t=a.querySelector("#".concat(o)),n=l.__setAttribute(e,"data-clone_id",o,i),t&&(t.id=n)),r&&(n=a.querySelector("#".concat(r)),r=l.__setAttribute(e,"data-clone_name",r,i),n&&(n.id=r))}),n.forEach(function(e){e.getAttribute("data-clone_id")&&e.setAttribute("data-clone_id",i)})},__getOriginal:function(e){var t=e,n=e.indexOf("_");return t=-1<n?e.substring(n+1):t},__setAttribute:function(e,t,n,o){n=this.__getOriginal(n),n=""==o?n:"".concat(o,"_").concat(n);return e.setAttribute(t,n),n},__createDnDElementId:function(e){document.querySelectorAll('[data-draggable="true"], [data-droppable="true"]').forEach(function(e){e.setAttribute("data-element_id",CoCreate.utils.generateUUID())}),"true"!=e.getAttribute("data-draggable")&&"true"!=e.getAttribute("data-droppable")||e.setAttribute("data-element_id",CoCreate.utils.generateUUID())},__getNewPrefix:function(t){var e=document.querySelectorAll(".clonedItem"),n=!1;return e.forEach(function(e){e=e.getAttribute("prefix");t==e&&(n=!0)}),n||!t?CoCreate.utils.generateUUID(12):t},__sendMessageOfClone:function(e,t,n,o){var r=e.getAttribute("data-document_id")||"",a=e.getAttribute("name")||"",e="";r&&(e="[data-document_id='".concat(r,"']"),a&&(e+="[name='".concat(a,"']")),CoCreate.message.send({rooms:[],emit:{message:"CoCreateClone-insert",data:{selector:"div.domEditor".concat(e," #").concat(n,".template"),element_str:t.outerHTML,position:o}}}))},__sendMessageOfDelete:function(e){CoCreate.message.send({rooms:[],emit:{message:"CoCreateClone-remove",data:{element_id:e}}})}};n.init(),CoCreateAction.registerEvent("cloneAction",n.cloneElement,n,"clone-cloned"),CoCreateAction.registerEvent("createClone",n.cloneElement,n,"clone-cloned"),CoCreateAction.registerEvent("deleteClone",n.deleteElement,n,"clone-deleted"),t.default=n}],r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0).default;function r(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}var n,o});